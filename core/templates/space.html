{% extends "base.html" %}

{% block core %}

	{% include "views/view_space.html" %}

	<div class="popup-bg"></div>
	<div class="popup" id="popupEditSpace">
		<button class="popup_btn-close">Zamknij</button>
		<h2>Edytuj przestrzeń</h2>
		<div id="editForm">
			{% include "forms/form_edit_space.html" %}
		</div>
	</div>
	<div class="popup" id="popupNewSpace">
		<button class="popup_btn-close">Zamknij</button>
		<h2>Dodaj przestrzeń</h2>
		<div id="newSpaceForm">
			{% include "forms/form_new_space.html" %}
		</div>
	</div>
	<div class="popup" id="popupAddCollaborators">
		<button class="popup_btn-close">Zamknij</button>
		<h2>Dodaj użytkowników</h2>
		<div id="addCollaboratorsForm">
			{% include "forms/form_add_collaborators.html" %}
		</div>
	</div>
    <div class="communicator" data-port="{{ user_key }}" data-username="{{ user.username }}" data-wsaddress="{{ websocket_server_address }}">
		<div class="communicator_head">
			<button id="add_btn" class="communicator_btn-add"><i class="fa fa-user-plus"></i></button>
			<button id="close_btn" class="communicator_btn-close"><i class="fa fa-times"></i></button>
		</div>
        <ul class="communicator_list">
			{% for chat_message in chat_messages %}
				{% if chat_message.user == user %}
					<li class="communicator_sender"><span class="communicator_author" title="{{ chat_message.time }}">{{ chat_message.user }}</span>{{ chat_message.text }}</li>
				{% else %}
					<li><span class="communicator_author" title="{{ chat_message.time }}">{{ chat_message.user }}</span>{{ chat_message.text }}</li>
				{% endif %}
			{% endfor %}
		</ul>
        <form id="sendChat">
            <input type="text" autocomplete="off" id="chatInput">
            <input type="submit" class="btn" value="Send">
        </form>
    </div>
	<div class="users-list">
		<div class="users-list_head">Ostatni rozmówca</div>
		<ul>
			<li><a href="" class="users-list_item is-online">Bartek</a></li>
		</ul>
		<div class="users-list_head">Użytkownicy</div>
		<ul id="users_list">
		{% for current_user in users_list %}
			<li><a href="" class="users-list_item">{{ current_user.username }}</a></li>
		{% endfor %}
		</ul>
		<div class="users-list_head">Konwersacje grupowe</div>
		<ul>
			<li><a href="" class="users-list_item">Bartek, Michał, Jakub, Łukasz, Lucjan</a></li>
		</ul>
	</div>
	<script src="/static/js/websocket.js"></script>
	<script src="/static/js/space.js"></script>
{% endblock %}
